<!DOCTYPE html>
<html lang="pl" _manifest="7cudow.appcache">
<head>
    <meta name="viewport" content="width=device-width">

    <link rel="manifest" href="manifest.json"/>
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="css/siedemcudow192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="css/siedemcudow192.png">
    <link rel="apple-touch-icon-precomposed" sizes="192x192" href="css/siedemcudow192.png">

    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-startup-image" href="css/siedemcudow192.png">

    <link rel="stylesheet" type="text/css" href="css/style.css">
    <title>7 Cudów Świata</title>
</head>
<body>
<div>
    <div style="display: none;">
        <span class="konflikt">Konflikty zbrojne</span>
        <span class="skarbiec">Zawartość skarbca</span>
        <span class="cuda">Cuda świata</span>
        <span class="cywilne">Budowle cywilne</span>
        <span class="naukowe">Budowle naukowe</span>
        <span class="handlowe">Budowle handlowe</span>
        <span class="gildie">Gildie</span>
    </div>

    <div class="group">
        <div class="title">Lista graczy</div>
        <div class="description">Nadaj nazwę każdemu z graczy.</div>
        <div>
            <table class="people nazwa">
               <!-- <tr><td>Gracz 1</td><td><input type="text" id="player1name"></td></tr>
                <tr><td>Gracz 2</td><td><input type="text" id="player2name"></td></tr>
                <tr><td>Gracz 3</td><td><input type="text" id="player3name"></td></tr> -->
            </table>
			<button class="add_player">Dodaj nowego gracza</button>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="konflikt">1. Konflikty zbrojne</span></div>
        <div class="description">Każdy z graczy dodaje swoje Żetony Zwycięstwa i Przegranej (suma może być ujemna!).</div>
        <div class="example">Przykład: Aleksandria zakończyła grę z żetonami: +1, +3, +5, -1, -1, -1 czyli w sumie 6 punktów.</div>
        <div>
            <table class="people konflikt">
              <!--  <tr><td class="player1name"></td><td><input class="player1points" type="number"></td></tr>
                <tr><td class="player2name"></td><td><input class="player2points" type="number"></td></tr>
                <tr><td class="player3name"></td><td><input class="player3points" type="number"></td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="skarbiec">2. Zawartość skarbca</span></div>
        <div class="description">Za każde 3 monety posiadane na koniec gry, gracz dostaje 1 punkt zwycięstwa. Pozostałe monety nie punktują.</div>
        <div class="example">Przykład: Aleksandria skończyła grę z 14 monetami w skarbcu za co otrzymuje 4 punkty zwycięstwa (4 razy po 3 monety i 2 monety reszty).</div>
        <div>
            <table class="people skarbiec">
               <!-- <tr><td class="player1name"></td><td><input class="player1points" type="number"></td></tr>
                <tr><td class="player2name"></td><td><input class="player2points" type="number"></td></tr>
                <tr><td class="player3name"></td><td><input class="player3points" type="number"></td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="cuda">3. Cuda świata</span></div>
        <div class="description">Każdy z graczy dodaje punkty uzyskane za swój Cud Świata.</div>
        <div class="example">Przykład: Aleksandria zakończyła wszystkie 3 etapy budowy Cudu Świata (strona planszy z symbolem [A]), warte w sumie 10 punktów zwycięstwa (3 punkty za pierwszy etap i 7 punktów za trzeci etap).</div>
        <div>
            <table class="people cuda">
              <!--  <tr><td class="player1name"></td><td><input class="player1points" type="number"></td></tr>
                <tr><td class="player2name"></td><td><input class="player2points" type="number"></td></tr>
                <tr><td class="player3name"></td><td><input class="player3points" type="number"></td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="cywilne">4. Budowle cywilne</span></div>
        <div class="description">Każdy gracz dodaje punkty uzyskane za wystawienie Budowli Cywilnych w liczbie zaznaczonej na karcie.</div>
        <div class="example">Przykład: Aleksandria wybudowała następujące budowle cywilne: Ołtarz (2 PZ), Akwedukt (5 PZ) i Ratusz Miejski (6 PZ), w sumie 13 punktów zwycięstwa.</div>
        <div>
            <table class="people cywilne">
              <!--  <tr><td class="player1name"></td><td><input class="player1points" type="number"></td></tr>
                <tr><td class="player2name"></td><td><input class="player2points" type="number"></td></tr>
                <tr><td class="player3name"></td><td><input class="player3points" type="number"></td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="naukowe">5. Budowle naukowe</span></div>
        <div class="description">
            <div>Za budowle naukowe punkty zdobywa się na dwa sposoby: przez zebranie zestawu jednakowych symboli lub zestawu 3 różnych symboli.</div>
            <div>Uważaj: Punkty zwycięstwa uzyskane obiema metodami kumulują się.</div>
            <div>
                <div><u>Zestawy jednakowych symboli</u></div>
                <div>Za każde 3 istniejące w grze symbole naukowe gracz otrzymuje punkty w następujący sposób:</div>
                <ul>
                    <li>tylko 1 symbol: 1 punkt zwycięstwa <span class="nauka-mala nauka1"></span></li>
                    <li>2 jednakowe symbole: 4 punkty zwycięstwa <span class="nauka-mala nauka1"></span><span class="nauka-mala nauka1"></span></li>
                    <li>3 jednakowe symbole: 9 punkty zwycięstwa <span class="nauka-mala nauka1"></span><span class="nauka-mala nauka1"></span><span class="nauka-mala nauka1"></span></li>
                    <li>4 jednakowe symbole: 16 punkty zwycięstwa <span class="nauka-mala nauka1"></span><span class="nauka-mala nauka1"></span><span class="nauka-mala nauka1"></span><span class="nauka-mala nauka1"></span></li>
                </ul>
                <div>Uwaga:</div>
                <ul>
                    <li>ilość uzyskanych punktów jest równa kwadratowi ilości powtórzeń symbolu.</li>
                    <li>są 4 zielone karty dla każdego symbolu, co daje maksymalną liczbę 16 punktów zwycięstwa za grupę.</li>
                    <li>wymienione wyżej maksimum może zostać zwiększone przez Gildię Naukowców oraz Cud Świata z Babilonu: 5 jednakowych symboli daje 25 punktów zwycięstwa, zaś 6 jednakowych symboli daje 36 punktów zwycięstwa.</li>
                </ul>
            </div>
        </div>
        <div class="example">Przykład: Aleksandria wystawiła 6 budowli naukowych z następującymi symbolami: 3 <span class="nauka-mala nauka1"></span>, 2 <span class="nauka-mala nauka2"></span>, <span class="nauka-mala nauka3"></span>1 . Dostaje 9 punktów za grupę 3 <span class="nauka-mala nauka1"></span> (3x3), 4 punkty za swoje <span class="nauka-mala nauka2"></span> (2x2) i jeden punkt za <span class="nauka-mala nauka3"></span> (1x1), w sumie 14 punktów zwycięstwa.</div>
        <div class="description">
            <div><u>Zestaw 3 różnych symboli</u></div>
            <div>Za każdą grupę 3 (<span class="nauka-mala nauka1"></span>+<span class="nauka-mala nauka2"></span>+<span class="nauka-mala nauka3"></span>) różnych symboli gracz uzyskuje 7 punktów zwycięstwa.</div>
        </div>
        <div class="example">Przykład: w powyższym przykładzie, Aleksandria ma 6 budowli naukowych, ale tylko jedną grupę 3 różnych symboli, a zatem dostaje dodatkowe 7 punktów zwycięstwa, co daje w sumie 21 punktów zwycięstwa. Jeśli Aleksandria miałaby jeszcze jedną budowlę z symbolem <span class="nauka-mala nauka3"></span> zdobyłaby (9+4+4) + (7+7) = 31 punktów zwycięstwa.</div>
        <div>
            <table class="people naukowe">
               <!-- <tr><td class="player1name"></td>
                <td>
                    <div><span class="nauka-mala nauka1"></span> x <input class="player1scpoints" type="number"></div>
                    <div><span class="nauka-mala nauka2"></span> x <input class="player1scpoints" type="number"></div>
                    <div><span class="nauka-mala nauka3"></span> x <input class="player1scpoints" type="number"></div>                    
                </td></tr>
                <tr><td class="player2name"></td>
                <td>
                    <div><span class="nauka-mala nauka1"></span> x <input class="player2scpoints" type="number"></div>
                    <div><span class="nauka-mala nauka2"></span> x <input class="player2scpoints" type="number"></div>
                    <div><span class="nauka-mala nauka3"></span> x <input class="player2scpoints" type="number"></div>                    
                </td></tr>
                <tr><td class="player3name"></td>
                <td>
                    <div><span class="nauka-mala nauka1"></span> x <input class="player3scpoints" type="number"></div>
                    <div><span class="nauka-mala nauka2"></span> x <input class="player3scpoints" type="number"></div>
                    <div><span class="nauka-mala nauka3"></span> x <input class="player3scpoints" type="number"></div>                    
                </td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="handlowe">6. Budowle handlowe</span></div>
        <div class="description">Niektóre Budowle Handlowe z III Ery dają punkty zwycięstwa.</div>
        <div class="example">Przykład: Aleksandria wystawiła Dom Handlowy. Ta budowla jest warta 2 punkty zwycięstwa za każdą szarą kartę w mieście. Aleksandria ma 2 szare karty zatem otrzymuje 4 punkty zwycięstwa.</div>
        <div>
            <table class="people handlowe">
             <!--   <tr><td class="player1name"></td><td><input class="player1points" type="number"></td></tr>
                <tr><td class="player2name"></td><td><input class="player2points" type="number"></td></tr>
                <tr><td class="player3name"></td><td><input class="player3points" type="number"></td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title"><span class="gildie">7. Gildie</span></div>
        <div class="description">Każda Gildia jest warta ilość punktów zależną od konfiguracji własnego miasta i/lub konfiguracji miast sąsiadujących (patrz opis budynków ).</div>
        <div class="example"></div>
        <div>
            <table class="people gildie">
              <!--  <tr><td class="player1name"></td><td><input class="player1points" type="number"></td></tr>
                <tr><td class="player2name"></td><td><input class="player2points" type="number"></td></tr>
                <tr><td class="player3name"></td><td><input class="player3points" type="number"></td></tr> -->
            </table>
        </div>
    </div>
	
	<div class="group">
        <div class="title"><span class="podsumowanie">Podsumowanie</span></div>
        <div class="description"> Sumowanie punktów z poszczególnych kategorii dla każdego gracza.</div>
        <div class="example"></div>
        <div>
            <table class="people podsumowanie">
             <!--   <tr><td class="player1name"></td><td><input class="player1total" type="number" readonly></td></tr>
                <tr><td class="player2name"></td><td><input class="player2total" type="number" readonly></td></tr>
                <tr><td class="player3name"></td><td><input class="player3total" type="number" readonly></td></tr> -->
            </table>
        </div>
    </div>

    <div class="group">
        <div class="title">STRATEGIA - PORADY</div>
        <div class="description"></div>
        <div class="example">
            <ul>
                <li>Blokuj swoich przeciwników: Grając w 7 Cudów Świata musisz przyglądać się uważnie obu sąsiadującym miastom by przewidywać ich strategię. Próbuj blokować ich, wykorzystując karty, które dałyby im zbyt dużą przewagę. Możesz użyć ich do ukończenia etapu budowy Cudu świata lub odrzucić jeśli potrzebujesz monet.</li>
                <li>Strategie: jest wiele strategii które mogą prowadzić do zwycięstwa: specjalizacja w budynkach jednego typu lub kolekcjonowanie różnorodnych budynków, budowa potęgi militarnej lub zlekceważenie wyścigu zbrojeń, wytwarzanie wielkiej ilości dóbr lub oparcie na handlu…</li>
                <li>Postęp: jeśli wystawiasz budowle naukowe, spróbuj tworzyć grupy różnych symboli, gdyż zazwyczaj dają one więcej punktów.</li>
            </ul>
        </div>
        <div>
        </div>
    </div>
</div>
<script type="text/javascript" src="jquery/jquery-3.1.1.js"></script>
<script type="text/javascript">
    $(document).ready(function(undefined) {
        "use strict";
        //var $ = document.querySelectorAll.bind(document);
		//var playersName = '#player1name, #player2name, #player3name, #player4name, #player5name, #player6name, #player7name';
		//var playersClass = '.player1name, .player2name, .player3name, .player4name, .player5name, .player6name, .player7name';
        /*function setName(player, name) {
            player.text(name);
        }*/
		
		var numPlayer = 1;
		
		function addPlayer(){
			var PlayerClass = {
					nazwa: 'Gracz '+numPlayer++,
					$nazwa: undefined,
					konflikt: 0,
					$konflikt: undefined,
					skarbiec: 0,
					$skarbiec: undefined,
					cuda: 0,
					$cuda: undefined,
					cywilne: 0,
					$cywilne: undefined,
					naukowe: { n1: 0 , n2: 0, n3: 0},
					$naukowe: { n1: undefined , n2: undefined, n3: undefined},
					handlowe: 0,
					$handlowe: undefined,
					gildie: 0,
					$gildie: undefined,
					suma: 0,
					$suma: undefined,
					$pomocnicze: []
				}
			var $szablonNazwaGracza = $(TemplateNazwaGracza);
			$szablonNazwaGracza.find('.playernumber').text(PlayerClass.nazwa)
			$('.people.nazwa').append($szablonNazwaGracza);
			PlayerClass.$nazwa = $szablonNazwaGracza.find('input');
			PlayerClass.$pomocnicze.push($szablonNazwaGracza);	
				
			var $szablonKonflikt = $(TemplateKonflikt);
			$('.people.konflikt').append($szablonKonflikt);
			PlayerClass.$konflikt = $szablonKonflikt.find('input');
			PlayerClass.$pomocnicze.push($szablonKonflikt);
			
			var $szablonSkarbiec = $(TemplateSkarbiec);
			$('.people.skarbiec').append($szablonSkarbiec);
			PlayerClass.$skarbiec = $szablonSkarbiec.find('input');
			PlayerClass.$pomocnicze.push($szablonSkarbiec);
			
			var $szablonCuda = $(TemplateCuda);
			$('.people.cuda').append($szablonCuda);
			PlayerClass.$cuda = $szablonCuda.find('input');
			PlayerClass.$pomocnicze.push($szablonCuda);
			
			var $szablonCywilne = $(TemplateCywilne);
			$('.people.cywilne').append($szablonCywilne);
			PlayerClass.$cywilne = $szablonCywilne.find('input');
			PlayerClass.$pomocnicze.push($szablonCywilne);
			
			var $szablonNaukowe = $(TemplateNaukowe);
			$('.people.naukowe').append($szablonNaukowe);
			PlayerClass.$naukowe.$n1 = $szablonNaukowe.find('.nauka1').next('input');
			PlayerClass.$naukowe.$n2 = $szablonNaukowe.find('.nauka2').next('input');
			PlayerClass.$naukowe.$n3 = $szablonNaukowe.find('.nauka3').next('input');
			PlayerClass.$pomocnicze.push($szablonNaukowe);
			
			var $szablonHandlowe = $(TemplateCuda);
			$('.people.handlowe').append($szablonHandlowe);
			PlayerClass.$handlowe = $szablonHandlowe.find('input');
			PlayerClass.$pomocnicze.push($szablonHandlowe);
			
			var $szablonGildie = $(TemplateCywilne);
			$('.people.gildie').append($szablonGildie);
			PlayerClass.$gildie = $szablonGildie.find('input');
			PlayerClass.$pomocnicze.push($szablonGildie);
			
			var $szablonPodsumowanie = $(TemplatePodsumowanie);
			$('.people.podsumowanie').append($szablonPodsumowanie);
			PlayerClass.$suma = $szablonPodsumowanie.find('span');
			PlayerClass.$pomocnicze.push($szablonPodsumowanie);
			
			PlayerClass.$nazwa.on('change', function(){
				PlayerClass.nazwa = PlayerClass.$nazwa.val();
				PlayerClass.$pomocnicze.forEach( function($e){
					$e.find('.playername').text(PlayerClass.nazwa);
				})
			})
			
			PlayerClass.$pomocnicze.forEach( function($e){
				$e.find('input').on('change', function(){
					sumPlayer(PlayerClass);
				})
			})
			
			$szablonNazwaGracza.find('.rem_player').on('click', function(){
				
				if(x > min_fields){
					var potw = confirm('Czy na pewno chcesz usunąć gracza "'+PlayerClass.nazwa+'"?');
					if(potw){
						removePlayer(PlayerClass);
					}
				}
				else{
					confirm('Nie można usunąć gracza "'+PlayerClass.nazwa+'", ponieważ liczba graczy nie może być mniejsza niż '+min_fields+'.');
				}
			})
			
			return PlayerClass;
		}
		
		function removePlayer(player)
		{
			// usuniecie pomocnicze
			player.$pomocnicze.forEach(function($e) {
				$e.remove();
			})
			player.$pomocnicze = [];
			x--;
		}
		
		function sumPlayer(player){
			player.konflikt = parseInt(player.$konflikt.val()) || 0;
			player.skarbiec = parseInt(player.$skarbiec.val()) || 0;
			player.cuda = parseInt(player.$cuda.val()) || 0;
			player.cywilne = parseInt(player.$cywilne.val()) || 0;
			player.naukowe.n1 = parseInt(player.$naukowe.$n1.val()) || 0;
			player.naukowe.n2 = parseInt(player.$naukowe.$n2.val()) || 0;
			player.naukowe.n3 = parseInt(player.$naukowe.$n3.val()) || 0;
			player.handlowe = parseInt(player.$handlowe.val()) || 0;
			player.gildie = parseInt(player.$gildie.val()) || 0;
			
			player.suma = player.konflikt + player.skarbiec + player.cuda + player.cywilne + player.handlowe + player.gildie;
			player.suma += parseInt(Math.pow(player.naukowe.n1,2)) + parseInt(Math.pow(player.naukowe.n2,2)) + parseInt(Math.pow(player.naukowe.n3,2));
			player.suma += Math.min(player.naukowe.n1,player.naukowe.n2,player.naukowe.n3) * 7; //7 punktów za każdą trójkę różnych kart
			player.$suma.text(player.suma);
		}
		
		var TemplateNazwaGracza = '<tr><td class="playernumber">Gracz </td><td><input type="text"></td><td><button class="rem_player">Usuń</button></td></tr>',
			TemplatePodsumowanie = '<tr><td class="playername"></td><td><span style="font-weight: bold"></span></td></tr>',
			TemplateKonflikt = '<tr><td class="playername"></td><td><input type="number" min="-6" max="18"/></td></tr>',
			TemplateSkarbiec = '<tr><td class="playername"></td><td><input type="number" min="0" max="24"></td></tr>',
			TemplateCuda = '<tr><td class="playername"></td><td><input type="number" min="0" max="20"></td></tr>',
			TemplateCywilne = '<tr><td class="playername"></td><td><input type="number" min="0" max="55"></td></tr>',
			TemplateNaukowe = '<tr><td class="playername"></td><td>'+
					'<div><span class="nauka-mala nauka1"></span> x <input type="number" min="0" max="6"></div>'+
                    '<div><span class="nauka-mala nauka2"></span> x <input type="number" min="0" max="6"></div>'+
                    '<div><span class="nauka-mala nauka3"></span> x <input type="number" min="0" max="6"></div> </td></tr>';
			

		/*function sumPoints(playerPoints) {
			var points = 0;
			var min = 5;
			$(playerPoints).each(function(){ 
				if(this.className.substring(7) == 'scpoints') {
					points += parseInt(Math.pow(this.value,2)) || 0;
					min = Math.min(min,this.value || 0);
				}
				else {
					points += parseInt(this.value) || 0;
				}
			});
			var totalPoints = playerPoints[0].className.substring(0,7)+'total';
			$('.'+totalPoints).val(points + 7 * min);
        }*/
		
		
        /*$('#player1name')[0].addEventListener('change', function() {
            setName($('.player1name'), this.value);
        });
        $('#player2name')[0].addEventListener('change', function() {
            setName($('.player2name'), this.value);
        });
        $('#player3name')[0].addEventListener('change', function() {
            setName($('.player3name'), this.value);
        });
        $('#player4name')[0].addEventListener('change', function() {
            setName($('.player4name'), this.value);
        });
        $('#player5name')[0].addEventListener('change', function() {
            setName($('.player5name'), this.value);
        });*/
		
		/*$(document).on('change', playersName, function() {
			setName($('.'+this.id), this.value);
		});
		
		$(document).on('change', "input[class$='points']", function() { 
			var classList = $("[class ^= "+this.className.substring(0,7)+"][class $='points']");
			sumPoints(classList);
		});*/
		
		var min_fields		= 3; // minimalna liczba graczy
		var max_fields      = 7; // maksymalna liczba graczy
		//var wrapper         = $("table.people"); // klasa people
		var add_button      = $(".add_player"); // ID przycisku do dodawania
		var rem_button		= $(".rem_player"); // ID przycisku do usuwania

		for(var i = 0; i < min_fields; i++)
		{
			addPlayer();
		}
		
		var nameClasses	= ".konflikt, .skarbiec, .cuda, .cywilne, .handlowe, .gildie";
		var x = min_fields; // początkowa liczba graczy
		$(add_button).click(function(e){ 
			e.preventDefault();
			if(x < max_fields){
				addPlayer();
				x++;
			}
			return;
			/*if(x < max_fields){ 
			//dodajemy gracza
				x++; 
				$(wrapper).filter('.nazwa').append('<tr><td>Gracz '+x+'</td><td><input type="text" id="player'+x+'name"></td></tr>');
				$(wrapper).filter(nameClasses).append('<tr><td class="player'+x+'name"></td><td><input class="player'+x+'points" type="number"></td></tr>');
				$(wrapper).filter('.podsumowanie').append('<tr><td class="player'+x+'name"></td><td><input class="player'+x+'total" type="number" readonly></td></tr>');
				$(wrapper).filter('.naukowe').append('<tr><td class="player'+x+'name"></td><td>'+
					'<div><span class="nauka-mala nauka1"></span> x <input class="player'+x+'scpoints" type="number"></div>'+
                    '<div><span class="nauka-mala nauka2"></span> x <input class="player'+x+'scpoints" type="number"></div>'+
                    '<div><span class="nauka-mala nauka3"></span> x <input class="player'+x+'scpoints" type="number"></div> </td></tr>');
			} */
		});
		
		
		/*$(rem_button).click(function(e){
			e.preventDefault();
			if(x > min_fields){ 
				$("table.people tr:last-child").remove(); //usuń ostatniego gracza
				x--; 
				//playersName = playersName.substring(0,14 * x - 2);
			} 
		});*/
	
    });
</script>
</body>
</html>